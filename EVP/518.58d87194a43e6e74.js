"use strict";(self.webpackChunkEVP=self.webpackChunkEVP||[]).push([[518],{518:(x,f,o)=>{o.r(f),o.d(f,{FinanceModule:()=>ut});var s=o(9808),d=o(1083),C=o(520),p=o(3075),_=o(58),m=o(4565),t=o(5e3),u=o(5384),T=o(3122),v=o(6640),y=o(4383),P=o(7603),D=o(7322),F=o(8833),A=o(5245),g=o(2075),S=o(3556);function E(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"mat-icon",18),t.NdJ("click",function(){return t.CHM(n),t.oxw().closeSearch()}),t._uU(1,"cancel"),t.qZA()}}function U(e,i){1&e&&(t.TgZ(0,"div",19)(1,"div",20)(2,"div",21),t._UZ(3,"img",22),t.TgZ(4,"h4"),t._uU(5,"No Records to show"),t.qZA()()()())}function N(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"No"),t.qZA())}function I(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.index,a=t.oxw(2);t.xp6(1),t.hij(" ",a.currentPager.startIndex+n+1," ")}}function O(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"Activity ID"),t.qZA())}function Y(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.activityId," ")}}function M(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"Activity Name"),t.qZA())}function b(e,i){if(1&e&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.s9C("title",n.activityName),t.xp6(1),t.hij(" ",n.activityName," ")}}function z(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"Activity End Date"),t.qZA())}function w(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.activityEndDate," ")}}function B(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"Location"),t.qZA())}function L(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.activityLocation," ")}}function Q(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1," Estimated Material/Campaigning/Creative Expense "),t.qZA())}function j(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.materialOrCreativeExpense," ")}}function R(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1," Actual Material/Campaigning/Creative Expense "),t.qZA())}function J(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.actualMaterialExpense?n.actualMaterialExpense:0," ")}}function $(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1," Estimated Logistic Expense "),t.qZA())}function k(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.logisticExpense," ")}}function q(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"Actual Logistic Expense"),t.qZA())}function G(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.actualLogisticExpense?n.actualLogisticExpense:0," ")}}function K(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1," Estimated Gratification Expense "),t.qZA())}function V(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.gratificationExpense," ")}}function W(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1," Actual Gratification Expense "),t.qZA())}function H(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.actualGratificationExpense?n.actualGratificationExpense:0," ")}}function X(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"Estimated Others"),t.qZA())}function tt(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.otherExpense," ")}}function et(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"Actual Others"),t.qZA())}function nt(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.actualOtherExpense?n.actualOtherExpense:0," ")}}function it(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"Estimated Total"),t.qZA())}function at(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.estimateTotal?n.estimateTotal:0," ")}}function ot(e,i){1&e&&(t.TgZ(0,"th",46),t._uU(1,"Actual Total"),t.qZA())}function ct(e,i){if(1&e&&(t.TgZ(0,"td",47),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.xp6(1),t.hij(" ",n.actualTotal?n.actualTotal:0," ")}}function lt(e,i){1&e&&t._UZ(0,"tr",49)}function st(e,i){1&e&&t._UZ(0,"tr",50)}function pt(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"div",23)(1,"table",24),t.ynx(2,25),t.YNc(3,N,2,0,"th",26),t.YNc(4,I,2,1,"td",27),t.BQk(),t.ynx(5,28),t.YNc(6,O,2,0,"th",26),t.YNc(7,Y,2,1,"td",27),t.BQk(),t.ynx(8,29),t.YNc(9,M,2,0,"th",26),t.YNc(10,b,2,2,"td",30),t.BQk(),t.ynx(11,31),t.YNc(12,z,2,0,"th",26),t.YNc(13,w,2,1,"td",27),t.BQk(),t.ynx(14,32),t.YNc(15,B,2,0,"th",26),t.YNc(16,L,2,1,"td",27),t.BQk(),t.ynx(17,33),t.YNc(18,Q,2,0,"th",26),t.YNc(19,j,2,1,"td",27),t.BQk(),t.ynx(20,34),t.YNc(21,R,2,0,"th",26),t.YNc(22,J,2,1,"td",27),t.BQk(),t.ynx(23,35),t.YNc(24,$,2,0,"th",26),t.YNc(25,k,2,1,"td",27),t.BQk(),t.ynx(26,36),t.YNc(27,q,2,0,"th",26),t.YNc(28,G,2,1,"td",27),t.BQk(),t.ynx(29,37),t.YNc(30,K,2,0,"th",26),t.YNc(31,V,2,1,"td",27),t.BQk(),t.ynx(32,38),t.YNc(33,W,2,0,"th",26),t.YNc(34,H,2,1,"td",27),t.BQk(),t.ynx(35,39),t.YNc(36,X,2,0,"th",26),t.YNc(37,tt,2,1,"td",27),t.BQk(),t.ynx(38,40),t.YNc(39,et,2,0,"th",26),t.YNc(40,nt,2,1,"td",27),t.BQk(),t.ynx(41,41),t.YNc(42,it,2,0,"th",26),t.YNc(43,at,2,1,"td",27),t.BQk(),t.ynx(44,42),t.YNc(45,ot,2,0,"th",26),t.YNc(46,ct,2,1,"td",27),t.BQk(),t.YNc(47,lt,1,0,"tr",43),t.YNc(48,st,1,0,"tr",44),t.qZA()(),t.TgZ(49,"div")(50,"app-pagination",45),t.NdJ("pageChange",function(c){return t.CHM(n),t.oxw().onPageChange(c)}),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(1),t.Q6J("dataSource",n.pagedItems),t.xp6(46),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(2),t.Q6J("page",n.currentPage)("pageSize",n.pageSize)("totalItems",n.totalItems)}}let Z=(()=>{class e{constructor(n,a,c,l,h,r){this.apiService=n,this.filterService=a,this.pagerService=c,this.toastr=l,this.communicationService=h,this.route=r,this.displayedColumns=["No","Activity ID","Name","Activity Date","Location","Estimated","Actual","Logistic","ActualLogistics","Gratification","Gratifi","Others","AOthers","Total","ATotal"],this.pager={},this.pagedItems=[],this.currentPage=1,this.totalItems=0,this.pageSize=5,this.searchControl=new p.NI(""),this.currentPager={}}ngOnInit(){this.dropDownSubscription=this.filterService.getdrpdwnValues().subscribe(n=>{n&&("/finance/finance-list"==this.apiService.currentRouteUrl||this.apiService.currentRouteUrl.includes("/finance/finance-list"))&&(this.globalSearchParams=n,this.currentPage=1,this.route.queryParams.subscribe(a=>{const c=(null==a?void 0:a.activityType)?atob(null==a?void 0:a.activityType):"";c?(this.activityType=c,this.getFinanceDetails("initial")):this.getFinanceDetails("initial")}))})}ngOnDestroy(){this.dropDownSubscription&&this.dropDownSubscription.unsubscribe()}getFinanceDetails(n){this.searchControl.value?(this.financeSearchParams=`${this.globalSearchParams}:fieldValueToSearch=${this.searchControl.value}`,this.currentPage=1):this.financeSearchParams=this.globalSearchParams;let a=(new C.LE).set("searchCriteria",this.financeSearchParams.toString().trim()).set("pageNo",this.currentPage).set("pageSize",this.pageSize);this.activityType&&(a=a.append("activityType",this.activityType));const c=`${_.J.activityFinancialUrl()}?${a} `;this.apiService.get(c).subscribe({next:l=>{var h,r;(null==l?void 0:l.data)&&(this.totalItems=null===(h=null==l?void 0:l.data)||void 0===h?void 0:h.totalElements,this.setPage(this.currentPage,null===(r=null==l?void 0:l.data)||void 0===r?void 0:r.activityFinancials,n))},error:()=>{this.totalItems=0,this.setPage(1,[],n)},complete:()=>{}})}setPage(n,a,c){"initial"==c&&(this.currentPager=this.pagerService.getPager(this.totalItems,n,this.pageSize)),this.pager=this.pagerService.getPager(a&&a.length?a.length:0,n,this.pageSize),this.currentPage=n,this.pagedItems=a}onPageChange(n){n.pager&&(this.currentPager=n.pager,this.currentPage=this.currentPager.currentPage,this.getFinanceDetails("normal"))}searchParticipation(){this.searchControl.value&&(this.getFinanceDetails("initial"),this.currentPage=1)}closeSearch(){this.searchControl.setValue(""),this.getFinanceDetails("initial")}onChangeState(){this.searchControl.value||this.getFinanceDetails("initial")}downloadFinanceCsv(){const n=(new C.LE).set("searchCriteria",this.financeSearchParams.toString().trim()).set("category","Finance"),a=`${m.K.downloadCsvUrl()}?${n}`;this.communicationService.post(a,"",{responseType:"text"}).subscribe({next:c=>{if(c){const l=new Blob([c],{type:"text/csv"}),h=window.URL.createObjectURL(l),r=document.createElement("a");r.href=h,r.download=`${Date.now()}-finance.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(h)}},error:c=>{this.toastr.error(c)},complete:()=>{}})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.s),t.Y36(T.Z),t.Y36(v.e),t.Y36(y._W),t.Y36(P.O),t.Y36(d.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-finance-details"]],decls:24,vars:4,consts:[[1,"page__wrapper"],[1,"content-section"],[1,"container-fluid","page__content-block"],[1,"page__header"],[1,"page__tabContainer"],[1,"page__heading"],[1,"page__rightColumn","participation"],["type","button",1,"btn","btn-grey",3,"click"],["src","assets\\images\\download.svg","alt",""],[1,"example-form"],["appearance","outline",1,"m-0","p-0"],[1,"flbx-stretch"],["type","tel","matInput","",3,"formControl","keyup.enter","change"],[1,"tb-search-ico"],["class","cancel","matSuffix","",3,"click",4,"ngIf"],["matSuffix","",3,"click"],["class","document-listing",4,"ngIf","ngIfElse"],["showData",""],["matSuffix","",1,"cancel",3,"click"],[1,"document-listing"],[1,"no-data-box"],[1,"no-data"],["src","assets\\images\\activities\\nodata.png","alt","no data"],[1,"common-table"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","No"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Activity ID"],["matColumnDef","Name"],["mat-cell","","class","act-name",3,"title",4,"matCellDef"],["matColumnDef","Activity Date"],["matColumnDef","Location"],["matColumnDef","Estimated"],["matColumnDef","Actual"],["matColumnDef","Logistic"],["matColumnDef","ActualLogistics"],["matColumnDef","Gratification"],["matColumnDef","Gratifi"],["matColumnDef","Others"],["matColumnDef","AOthers"],["matColumnDef","Total"],["matColumnDef","ATotal"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","pageSize","totalItems","pageChange"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"act-name",3,"title"],["mat-header-row",""],["mat-row",""]],template:function(n,a){if(1&n&&(t.TgZ(0,"div",0)(1,"section",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),t._uU(6,"Finance Details"),t.qZA()(),t.TgZ(7,"div",6)(8,"button",7),t.NdJ("click",function(){return a.downloadFinanceCsv()}),t._UZ(9,"img",8),t._uU(10," Download CSV "),t.qZA(),t.TgZ(11,"form",9)(12,"mat-form-field",10)(13,"mat-label"),t._uU(14,"Activity Id & Name"),t.qZA(),t.TgZ(15,"div",11)(16,"input",12),t.NdJ("keyup.enter",function(){return a.searchParticipation()})("change",function(){return a.onChangeState()}),t.qZA(),t.TgZ(17,"span",13),t.YNc(18,E,2,0,"mat-icon",14),t.TgZ(19,"mat-icon",15),t.NdJ("click",function(){return a.searchParticipation()}),t._uU(20,"search"),t.qZA()()()()()()(),t.YNc(21,U,6,0,"div",16),t.YNc(22,pt,51,6,"ng-template",null,17,t.W1O),t.qZA()()()),2&n){const c=t.MAs(23);t.xp6(16),t.Q6J("formControl",a.searchControl),t.xp6(2),t.Q6J("ngIf",null==a.searchControl?null:a.searchControl.value),t.xp6(3),t.Q6J("ngIf",0===(null==a.pagedItems?null:a.pagedItems.length))("ngIfElse",c)}},directives:[p._Y,p.JL,p.F,D.KE,D.hX,F.Nt,p.Fj,p.JJ,p.oH,s.O5,A.Hw,D.R9,g.BZ,g.w1,g.fO,g.ge,g.Dz,g.ev,g.as,g.XQ,g.nj,g.Gk,S.Q],styles:[".page__rightColumn[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{display:flex;max-height:41px;width:max-content}@media screen and (max-width: 768px){.page__rightColumn[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}}.page__rightColumn[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:5px}.page__rightColumn[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]{padding-bottom:0!important;margin-bottom:0!important}table[_ngcontent-%COMP%]{width:100%}.act-name[_ngcontent-%COMP%]{width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:200px}"]}),e})();const mt=[{path:"",component:Z},{path:"finance-list",component:Z}];let rt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[d.Bz.forChild(mt)],d.Bz]}),e})();var gt=o(7777),_t=o(8882);let ut=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[s.ez,rt,gt.m,_t.u]]}),e})()},3556:(x,f,o)=>{o.d(f,{Q:()=>p});var s=o(5e3),d=o(6640),C=o(3585);let p=(()=>{class _{constructor(t){this.pagerService=t,this.pageChange=new s.vpe,this.pager={}}ngOnInit(){this.pager=this.pagerService.getPager(this.totalItems,this.page,this.pageSize)}ngOnChanges(t){t.totalItems&&(this.totalItems=t.totalItems.currentValue,this.pager=this.pagerService.getPager(this.totalItems,this.page,this.pageSize)),t.page&&(this.page=t.page.currentValue,this.pager=this.pagerService.getPager(this.totalItems,this.page,this.pageSize)),t.pageSize&&(this.pageSize=t.pageSize.currentValue,this.pager=this.pagerService.getPager(this.totalItems,this.page,this.pageSize))}setPage(t){this.pager=this.pagerService.getPager(this.totalItems,t,this.pageSize),this.pageChange.emit({pager:this.pager})}}return _.\u0275fac=function(t){return new(t||_)(s.Y36(d.e))},_.\u0275cmp=s.Xpm({type:_,selectors:[["app-pagination"]],inputs:{page:"page",pageSize:"pageSize",totalItems:"totalItems"},outputs:{pageChange:"pageChange"},features:[s.TTD],decls:2,vars:7,consts:[[1,"pagination","justify-content-end"],[3,"collectionSize","page","pageSize","maxSize","rotate","ellipses","boundaryLinks","pageChange"]],template:function(t,u){1&t&&(s.TgZ(0,"div",0)(1,"ngb-pagination",1),s.NdJ("pageChange",function(v){return u.pager.currentPage=v})("pageChange",function(v){return u.setPage(v)}),s.qZA()()),2&t&&(s.xp6(1),s.Q6J("collectionSize",u.totalItems)("page",u.pager.currentPage)("pageSize",u.pager.pageSize)("maxSize",3)("rotate",!0)("ellipses",!0)("boundaryLinks",!0))},directives:[C.N9],styles:[""]}),_})()},8882:(x,f,o)=>{o.d(f,{u:()=>_});var s=o(9808),d=o(7777),C=o(3585),p=o(5e3);let _=(()=>{class m{}return m.\u0275fac=function(u){return new(u||m)},m.\u0275mod=p.oAB({type:m}),m.\u0275inj=p.cJS({imports:[[s.ez,d.m,C.jF]]}),m})()}}]);